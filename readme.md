# ИНСТРУКЦИЯ ПО ЗАПУСКУ ПРОГРАММЫ

- Инициализировать env (виртуальное окружение): "python3 -m venv env"

- Запустить виртуальное окружение: "env\Scripts\activate"  | *(должно появиться (env) в терминале)*

- Установить зависимости из requirements.txt: "pip3 install -r requirements.txt"

- cfg.py - вы должны создать сами, я оставлю пример в каталоге (cfg_example.py который надо будет переименовать в cfg.py)

*Выполните следующие шаги для компиляции (если это нужно):*

1. **Установите PyInstaller:**
Откройте терминал и выполните следующую команду:

'''
(bash)
pip install pyinstaller
'''

2. **Перейдите в каталог с вашими файлами:**
В терминале перейдите в каталог, содержащий ваши файлы main.py, cfg.py, и root_chromedriver.py.

'''
(bash)
cd /путь/к/вашему/каталогу
'''

3. **Скомпилируйте скрипт с PyInstaller:**
Выполните следующую команду:

'''
(bash)
pyinstaller --onefile main.py
Это создаст каталог dist в текущем местоположении, а внутри него будет исполняемый файл, имеющий то же имя, что и ваш скрипт, без расширения.
'''

'''
(bash)
cd dist
'''

4. **Запустите ваш исполняемый файл:**
Вы можете выполнить ваш исполняемый файл в терминале:

'''
(bash)
python3 main.py
'''

# (для MacOS) Есть вторая вариация - создание ".app" файла:

'''
(bash)
pyinstaller --onefile --windowed main.py
Затем в каталоге dist появится .app файл, подобный .exe на Windows который можно запустить простым щелчком.
'''

## Настройка файла `cfg.py`

- Настройки которые *вам придёться установить* это [MAIL_LOGIN, MAIL_PASSWORD, MAIL_SEND_TO]. Остальное можно оставить, всё будет работать корректно.

- Укажите PATH до OCR тессеракта. Если исполняемый файл не будет найден по указанному пути, программа отправит сообщение об ошибке на целевой адрес электронной почты. Ссылки для тессеракта как для Windows, так и для MacOS доступны в `cfg.py`.

- Можно изменить filepath (пути) до файлов в которые будет запись данных (avito_total, avito_history, ...)

- Можно изменить формат сохранения временных меток для *объявлений* этот пункт называеться 'TIMESTAMP_DT_FORMAT'

- Так как программа было создана для парсинга *Москвы и Московской области только!*, то в настройках региона вы можете поменять **только значения, без ключей!**, если вы поменяете ключи (это то что указываеться до доветочий ":") то *программа упадёт с ошибкой*, я сделал это специально чтобы *регионы указывались изначально корректно!*

## Процесс работы программы

- В окне программы будут появляться объявления, полученные с сайта и которые будут сохранены в CSV. В конце работы парсера будет назначено новое время для запуска.

- *Процесс работы программы записываеться* в **execution.log**, если в случае чего *ошибки не были высланы на целевую почту их можно будет посмотреть*, так же посмотреть *количество собранных объявлений*

- **При возниковении любых ошибок** уведомление должно будет отправлено вам на почту к MAIL_SEND_TO пользователю **если пароль и логин был задан верно!**

## После работы программы

- Total CSV файлы будут автоматически пополняться новыми объявлениями, содержащими всю необходимую информацию. Из истории можно будет взять айдишник и найти его в Total CSV, чтобы получить более подробные данные об объявлении. History CSV будет постоянно обновляться: спарсенные данные о цене и просмотрах будут сохраняться сверху, а ID объявлений будут группироваться для удобства чтения. Время в файлах будет отражать текущую дату и время (на момент парсинга).

- *execution_log.txt* будет обновляться сообщениями о начале, окончании, ошибках, и собранных объявлений в программе, как *после парсинга*, так и *после попыток обновления total и history файлов*
